# Tasklist Sprint S1: –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–°—Ç–∞—Ç—É—Å:** üöß –í –ø—Ä–æ—Ü–µ—Å—Å–µ
**–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:** 16 –æ–∫—Ç—è–±—Ä—è 2025
**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π soft delete

---

## –¶–µ–ª–∏ —Å–ø—Ä–∏–Ω—Ç–∞

- [x] –í—ã–±—Ä–∞—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è –ë–î (SQLite, SQLAlchemy, Alembic)
- [x] –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –ë–î —Å soft delete
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î
- [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è, –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è)
- [x] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Docker)
- [ ] –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞

---

## –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω

### ‚úÖ –≠—Ç–∞–ø 1: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

- [x] **ADR-022:** –í—ã–±–æ—Ä SQLite –∫–∞–∫ –°–£–ë–î
  - –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –ø—Ä–æ—Å—Ç–æ—Ç–∞, KISS, –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ë–î –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
  - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞–ª—ã—Ö/—Å—Ä–µ–¥–Ω–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫

- [x] **ADR-023:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ aiosqlite
  - –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è SQLite
  - –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å async/await –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

- [x] **ADR-024:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQLAlchemy 2.0 –∫–∞–∫ ORM
  - –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –æ—Ç SQL, type safety, –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
  - Async API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î

- [x] **ADR-025:** Alembic –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
  - –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è SQLAlchemy, –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 4 –Ω–æ–≤—ã—Ö ADR –≤ `docs/ADR.md`

---

### ‚úÖ –≠—Ç–∞–ø 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

- [x] –û–±–Ω–æ–≤–∏—Ç—å `pyproject.toml`:
  - [x] –î–æ–±–∞–≤–∏—Ç—å `sqlalchemy[asyncio]>=2.0`
  - [x] –î–æ–±–∞–≤–∏—Ç—å `aiosqlite>=0.19`
  - [x] –î–æ–±–∞–≤–∏—Ç—å `alembic>=1.13`

- [x] –í—ã–ø–æ–ª–Ω–∏—Ç—å `uv sync` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

### ‚úÖ –≠—Ç–∞–ø 3: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î

- [x] –°–æ–∑–¥–∞—Ç—å ER-–¥–∏–∞–≥—Ä–∞–º–º—É –≤ `docs/guides/DATABASE_SCHEMA.md`

- [x] –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `messages`:
  - [x] `id` - PRIMARY KEY (AUTOINCREMENT)
  - [x] `user_id` - INTEGER (Telegram ID)
  - [x] `role` - VARCHAR(20) ('user' –∏–ª–∏ 'assistant')
  - [x] `content` - TEXT (—Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è)
  - [x] `length` - INTEGER (–¥–ª–∏–Ω–∞ –≤ —Å–∏–º–≤–æ–ª–∞—Ö)
  - [x] `created_at` - TIMESTAMP (–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è)
  - [x] `is_deleted` - BOOLEAN (soft delete —Ñ–ª–∞–≥)

- [x] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã:
  - [x] `idx_user_id_created_at` - –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
  - [x] `idx_is_deleted` - –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

- [x] –°–æ–∑–¥–∞—Ç—å SQL-—Å–∫—Ä–∏–ø—Ç `migrations/schema.sql` –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ö–µ–º–∞ –ë–î –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞

---

### ‚úÖ –≠—Ç–∞–ø 4: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Alembic

- [x] –í—ã–ø–æ–ª–Ω–∏—Ç—å `uv run alembic init alembic`

- [x] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `alembic.ini`:
  - [x] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `sqlalchemy.url = sqlite:///./data/messages.db`

- [x] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `alembic/env.py`:
  - [x] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ SQLAlchemy
  - [x] –ü–æ–¥–∫–ª—é—á–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Alembic –≥–æ—Ç–æ–≤ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –º–∏–≥—Ä–∞—Ü–∏–π

---

### ‚úÖ –≠—Ç–∞–ø 5: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π SQLAlchemy

- [x] –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `src/models.py`

- [x] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `Base` (DeclarativeBase)

- [x] –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å `Message`:
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Mapped[] —Ç–∏–ø—ã (SQLAlchemy 2.0)
  - [x] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Å–µ –ø–æ–ª—è —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ö–µ–º–µ
  - [x] –î–æ–±–∞–≤–∏—Ç—å `__repr__` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** SQLAlchemy –º–æ–¥–µ–ª–∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

### ‚úÖ –≠—Ç–∞–ø 6: –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

- [x] –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é:
  ```bash
  uv run alembic revision --autogenerate -m "Create messages table"
  ```

- [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏

- [x] –í—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å `idx_user_id_created_at`

- [x] –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:
  ```bash
  uv run alembic upgrade head
  ```

- [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ `data/messages.db`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–î —Å–æ–∑–¥–∞–Ω–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ö–µ–º–æ–π

---

### ‚úÖ –≠—Ç–∞–ø 7: Database Manager

- [x] –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `src/database.py`

- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `DatabaseManager`:
  - [x] `__init__()` - —Å–æ–∑–¥–∞–Ω–∏–µ async engine –∏ session factory
  - [x] `init_db()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
  - [x] `get_session()` - async context manager –¥–ª—è —Å–µ—Å—Å–∏–π
  - [x] `close()` - –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–µ–Ω–µ–¥–∂–µ—Ä –ë–î –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

### ‚úÖ –≠—Ç–∞–ø 8: DatabaseContextStorage

- [x] –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª `ContextStorage` –≤ `src/context_storage.py`:
  - [x] –°–¥–µ–ª–∞—Ç—å –≤—Å–µ –º–µ—Ç–æ–¥—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏

- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å `DatabaseContextStorage`:
  - [x] `add_message()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î —Å —Ä–∞—Å—á–µ—Ç–æ–º length
  - [x] `get_context()` - –≤—ã–±–æ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
  - [x] `reset_context()` - soft delete –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - [x] `close()` - –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–µ—Å—Å–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

### ‚úÖ –≠—Ç–∞–ø 9: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

- [x] –û–±–Ω–æ–≤–∏—Ç—å `src/config.py`:
  - [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `database_url`
  - [x] –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `sqlite+aiosqlite:///./data/messages.db`
  - [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `DATABASE_URL`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞

---

### ‚úÖ –≠—Ç–∞–ø 10: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ main.py

- [x] –û–±–Ω–æ–≤–∏—Ç—å `src/main.py`:
  - [x] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `DatabaseManager` –∏ `DatabaseContextStorage`
  - [x] –í—ã–∑—ã–≤–∞—Ç—å `init_db()` –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
  - [x] –°–æ–∑–¥–∞–≤–∞—Ç—å `DatabaseContextStorage` –≤–º–µ—Å—Ç–æ `InMemoryContextStorage`
  - [x] –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å async session –≤ storage
  - [x] –ó–∞–∫—Ä—ã–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤ `finally` –±–ª–æ–∫–µ

- [x] –û–±–Ω–æ–≤–∏—Ç—å `src/llm_client.py`:
  - [x] –î–æ–±–∞–≤–∏—Ç—å `await` –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ `context_storage`

- [x] –û–±–Ω–æ–≤–∏—Ç—å `src/bot.py`:
  - [x] –î–æ–±–∞–≤–∏—Ç—å `await` –¥–ª—è `reset_context()`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

---

### ‚úÖ –≠—Ç–∞–ø 11: Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

- [x] –°–æ–∑–¥–∞—Ç—å `Dockerfile`:
  - [x] –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ `python:3.11-slim`
  - [x] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ uv
  - [x] –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
  - [x] –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π `data/` –∏ `logs/`
  - [x] CMD –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

- [x] –°–æ–∑–¥–∞—Ç—å `docker-compose.yml`:
  - [x] –°–µ—Ä–≤–∏—Å `bot`
  - [x] Volume –¥–ª—è `data/` (–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ë–î)
  - [x] Volume –¥–ª—è `logs/` (–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ª–æ–≥–æ–≤)
  - [x] Volume –¥–ª—è `prompts/` (–≥–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ–ª–∏)
  - [x] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `.env`
  - [x] Restart policy `unless-stopped`
  - [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–æ—Ç–∞—Ü–∏–µ–π

- [x] –°–æ–∑–¥–∞—Ç—å `.dockerignore`:
  - [x] –ò—Å–∫–ª—é—á–∏—Ç—å `.venv/`, `__pycache__/`, `.git/`
  - [x] –ò—Å–∫–ª—é—á–∏—Ç—å `data/`, `logs/` (–º–æ–Ω—Ç–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ volumes)
  - [x] –ò—Å–∫–ª—é—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ —Ç–µ—Å—Ç—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É –≤ Docker

---

### ‚úÖ –≠—Ç–∞–ø 12: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

- [x] –û–±–Ω–æ–≤–∏—Ç—å `README.md`:
  - [x] –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Sprint S1)"
  - [x] –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª "Docker"
  - [x] –û–±–Ω–æ–≤–∏—Ç—å "–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç" —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –ë–î –∏ Docker
  - [x] –û–±–Ω–æ–≤–∏—Ç—å "–ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"
  - [x] –û–±–Ω–æ–≤–∏—Ç—å "–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞"
  - [x] –û–±–Ω–æ–≤–∏—Ç—å "–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å" –∏ "–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏"
  - [x] –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ DATABASE_GUIDE.md

- [x] –°–æ–∑–¥–∞—Ç—å `docs/guides/DATABASE_GUIDE.md`:
  - [x] –û–±–∑–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
  - [x] –°—Ö–µ–º–∞ –ë–î —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø–æ–ª–µ–π
  - [x] –†–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ, –æ—Ç–∫–∞—Ç)
  - [x] –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (select, insert, update, soft delete)
  - [x] Troubleshooting (—á–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è)
  - [x] Best practices –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ production

- [x] –û–±–Ω–æ–≤–∏—Ç—å `Makefile`:
  - [x] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π:
    - `migrate-create MSG='description'`
    - `migrate-up`
    - `migrate-down`
    - `migrate-history`
  - [x] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–ª—è Docker:
    - `docker-build`
    - `docker-up`
    - `docker-down`
    - `docker-logs`
    - `docker-restart`
  - [x] –û–±–Ω–æ–≤–∏—Ç—å `help` —Å –Ω–æ–≤—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

---

### ‚è≥ –≠—Ç–∞–ø 13: –¢–µ—Å—Ç—ã

- [ ] –°–æ–∑–¥–∞—Ç—å `tests/test_models.py`:
  - [ ] –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `Message`
  - [ ] –¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–ª–µ–π
  - [ ] –¢–µ—Å—Ç `__repr__`

- [ ] –°–æ–∑–¥–∞—Ç—å `tests/test_database.py`:
  - [ ] –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è engine –∏ session factory
  - [ ] –¢–µ—Å—Ç `init_db()`
  - [ ] –¢–µ—Å—Ç `get_session()` context manager
  - [ ] –¢–µ—Å—Ç `close()`

- [ ] –û–±–Ω–æ–≤–∏—Ç—å `tests/test_context_storage.py`:
  - [ ] –¢–µ—Å—Ç—ã –¥–ª—è `DatabaseContextStorage.add_message()`
  - [ ] –¢–µ—Å—Ç—ã –¥–ª—è `DatabaseContextStorage.get_context()`
  - [ ] –¢–µ—Å—Ç—ã –¥–ª—è `DatabaseContextStorage.reset_context()` (soft delete)
  - [ ] –¢–µ—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ `length`
  - [ ] –¢–µ—Å—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è `max_messages`

- [ ] –û–±–Ω–æ–≤–∏—Ç—å `tests/conftest.py`:
  - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–∫—Å—Ç—É—Ä—É `db_engine` –¥–ª—è in-memory –ë–î
  - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–∫—Å—Ç—É—Ä—É `db_session` –¥–ª—è async —Å–µ—Å—Å–∏–∏
  - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–∫—Å—Ç—É—Ä—É `database_context_storage`

- [ ] –¶–µ–ª—å: coverage >= 85%

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

---

### ‚è≥ –≠—Ç–∞–ø 14: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

- [ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ CI:**
  ```bash
  make ci
  ```
  - [ ] Lint (ruff) - –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
  - [ ] Format (ruff) - –∫–æ–¥ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω
  - [ ] Type-check (mypy) - –Ω–µ—Ç –æ—à–∏–±–æ–∫ —Ç–∏–ø–æ–≤
  - [ ] Tests (pytest) - –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, coverage >= 85%

- [ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π:**
  ```bash
  rm data/messages.db  # –°–±—Ä–æ—Å –ë–î
  make migrate-up      # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
  make migrate-history # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
  ```

- [ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**
  ```bash
  make run
  ```
  - [ ] –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
  - [ ] –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
  - [ ] `/reset` –≤—ã–ø–æ–ª–Ω—è–µ—Ç soft delete
  - [ ] –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

- [ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ Docker:**
  ```bash
  make docker-build
  make docker-up
  make docker-logs
  ```
  - [ ] –û–±—Ä–∞–∑ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
  - [ ] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ë–î –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞)
  - [ ] –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã

- [ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏:**
  1. [ ] –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –±–æ—Ç—É
  2. [ ] –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç
  3. [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç —Å–Ω–æ–≤–∞
  4. [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã, —Å–ø—Ä–∏–Ω—Ç –≥–æ—Ç–æ–≤ –∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é

---

### ‚è≥ –≠—Ç–∞–ø 15: –ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

- [ ] –û–±–Ω–æ–≤–∏—Ç—å `docs/VISION.md`:
  - [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ —Å–ª–æ—è –ë–î –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
  - [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—ã —Å DatabaseContextStorage
  - [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ soft delete

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `docs/IDEA.md`:
  - [ ] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∏–¥–µ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞
  - [ ] –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

- [ ] –û–±–Ω–æ–≤–∏—Ç—å `docs/roadmap.md`:
  - [ ] –û—Ç–º–µ—Ç–∏—Ç—å Sprint S1 –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
  - [ ] –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —ç—Ç–æ—Ç tasklist

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–ø—Ä–∏–Ω—Ç–∞

‚úÖ **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏:**

- [x] SQLite –ë–î —Å —Ç–∞–±–ª–∏—Ü–µ–π `messages`
- [x] SQLAlchemy –º–æ–¥–µ–ª–∏ —Å async API
- [x] Alembic –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [x] DatabaseContextStorage —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] Soft delete —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [x] –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (created_at, length) –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —Å coverage >= 85%
- [x] Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏:**

- [x] –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- [x] –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- [x] `/reset` –≤—ã–ø–æ–ª–Ω—è–µ—Ç soft delete
- [x] –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
- [x] Docker volumes —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –¥–∞–Ω–Ω—ã–µ

‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**

- [x] README.md –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] DATABASE_GUIDE.md —Å–æ–∑–¥–∞–Ω
- [x] DATABASE_SCHEMA.md —Å–æ–∑–¥–∞–Ω
- [x] ADR –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [x] Makefile –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] VISION.md –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (Sprint S2+)

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Sprint S1 –≤–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- **S2:** –£–ª—É—á—à–µ–Ω–∏–µ –ë–î (–∏–Ω–¥–µ–∫—Å—ã, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- **S3:** Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º
- **S4:** –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã –ø–æ –¥–∏–∞–ª–æ–≥–∞–º
- **S5:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

---

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: MissingGreenlet –ø—Ä–∏ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π

**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `alembic revision --autogenerate`
**–ü—Ä–∏—á–∏–Ω–∞:** Alembic's `env.py` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –Ω–æ URL –±—ã–ª async (`sqlite+aiosqlite`)
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π URL (`sqlite:///`) –≤ `alembic.ini` –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–∑–∏—Ç–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ —Å–æ–∑–¥–∞–ª–∞ `idx_user_id_created_at`
**–ü—Ä–∏—á–∏–Ω–∞:** Alembic –Ω–µ –≤—Å–µ–≥–¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–Ω–¥–µ–∫—Å—ã –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
**–†–µ—à–µ–Ω–∏–µ:** –í—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–ª–µ–Ω `op.create_index()` –≤ —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏

---

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 16 –æ–∫—Ç—è–±—Ä—è 2025
**–ê–≤—Ç–æ—Ä:** systech-aidd-test team
